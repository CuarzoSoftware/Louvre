# Chapter 4: Backends

## Graphic Backends

Graphical backends in Louvre are dynamic libraries used to display the compositor on different contexts, such as on top of an X11 compositor, nested on another Wayland compositor, or directly on screen using DRM (Direct Rendering Manager).\n
The library offers two graphical backends located at ```/usr/etc/Louvre/backends``` which can be loaded dynamically when the compositor starts.

* **LGraphicBackendX11** : This backend displays the compositor on a fullscreen window on top of an X11 compositor.
* **LGraphicBackendDRM** : This backend displays the compositor directly on the screen using DRM.

The library loads the DRM backend by default.

## Input Backends

Just like graphical backends, input backends are dynamic libraries that let the compositor listen to events generated by a keyboard, mouse, touchpad, etc.\n

The library offers two input backends:

* **LInputBackendX11** : This backend provides access to input events generated by an X11 compositor. It must be used together with the X11 graphical backend.
* **LInputBackendLibinput** : This backend provides access to events generated by Libinput. It should be used together with the graphical DRM backend.

The library loads the Libinput backend by default.

## X11 Backends

Let's try the combination of **LGraphicBackendX11** and **LInputBackendX11** backends.

> ⚠️  If your current desktop environment is based on Wayland, skip to the [DRM & Libinput Backends](#DRM) section.

Double-click on the **main.cpp** file and replace its contents with the following:

<pre class="cpp-code"><span class="add">#include <LCompositor.h>

using namespace Louvre;

int main()
{
    LCompositor compositor;
    compositor.loadGraphicBackend("/usr/etc/Louvre/backends/libLGraphicBackendX11.so");
    compositor.loadInputBackend("/usr/etc/Louvre/backends/libLInputBackendX11.so");
    return compositor.start();
}
</span></pre>

We are creating an instance of the Louvre::LCompositor class, loading the backends, and starting the compositor with the Louvre::LCompositor::start() method.

> ⚠️ Before compiling and running it, remember that you can close the compositor by pressing the combination **Ctrl+Shift+Esc**, and launch **weston-terminal** by pressing **F1** or **fn+F1** depending on your keyboard configuration.

Click the **Run** button in QtCreator or press **Ctrl+R** to compile and run the compositor.

A compositor with white background should appear on the screen as shown in the following image:

<center>
    <img src="https://lh3.googleusercontent.com/j0zgugoPB7QUbdXPd7K5pSBFtVDqWAziwhA2sXHI7gFWmSFYdclRkNr3Mg3tF12xjPVrjScS0qleWyL6AN7p0hNgN6079wRSdvTZSs_JnIBQ6NHN_UI770p9zHbi49_V3zY8fFFGZQ=w2400"/>
</center>

## DRM & Libinput Backends {#DRM}

Let's try the combination of **LGraphicBackendDRM** and **LInputBackendLibinput** backends.

Double-click on the **main.cpp** file and replace its contents with the following:

<pre class="cpp-code">
#include <LCompositor.h>

using namespace Louvre;

int main()
{
    LCompositor compositor;
    return compositor.start();
}
</pre>

The library uses these backends by default, so it is not necessary to specify them as in the previous case.

Compile it and switch to a free TTY with the keyboard combination ```CTRL+ALT+(F1,F2,...,FN)``` or by running the \n```$ sudo chvt N``` command where N is the number of TTY. Finally, navigate to the project's build directory **build-MyFirstCompositor-Desktop_Qt_6_2_4_GCC_64bit-Debug** (or similar) and run the compositor.\n\n

Throughout the rest of the tutorial, we will continue using the DRM and Libinput backends.



